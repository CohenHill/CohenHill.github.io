<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Learn programming concepts and techniques for FTC robotics with PID programming.">
    <title>FTC Programming - PID</title>
    <link rel="stylesheet" href="style.css">
    <script>
        // JavaScript to handle the unified switch bar functionality
        function switchCode(language) {
            // Hide all code blocks and deactivate all buttons
            document.querySelectorAll('.code-box pre').forEach(pre => pre.style.display = 'none');
            document.querySelectorAll('.switch-bar button').forEach(button => button.classList.remove('active'));

            // Show the selected language's code blocks and activate the corresponding buttons
            document.querySelectorAll(`.${language}-code`).forEach(el => el.style.display = 'block');
            document.querySelectorAll(`.${language}-button`).forEach(btn => btn.classList.add('active'));
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Set default language to Java on page load
            switchCode('java');
        });
    </script>
</head>
<body>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Add fade-out animation when navigating to another page
            const links = document.querySelectorAll('a');
            links.forEach(link => {
                link.addEventListener('click', event => {
                    event.preventDefault();
                    document.body.classList.add('fade-out');
                    setTimeout(() => {
                        window.location.href = link.href;
                    }, 500);
                });
            });

            // Theme toggle functionality
            const themeToggle = document.getElementById('theme-toggle');
            const savedTheme = localStorage.getItem('theme') || 'light-mode';

            // Apply the saved theme
            document.body.classList.add(savedTheme);
            themeToggle.textContent = savedTheme === 'dark-mode' ? '⏾' : '☀';

            // Toggle theme on button click
            themeToggle.addEventListener('click', () => {
                const isDarkMode = document.body.classList.contains('dark-mode');
                document.body.classList.toggle('dark-mode', !isDarkMode);
                document.body.classList.toggle('light-mode', isDarkMode);
                themeToggle.textContent = isDarkMode ? '☀' : '⏾';
                localStorage.setItem('theme', isDarkMode ? 'light-mode' : 'dark-mode');
            });
        });
    </script>

    <!-- Navigation Bar -->
    <nav>
        <ul class="navbar" role="menu">
            <li role="menuitem"><a href="index.html">Home</a></li>
            <li role="menuitem"><a href="lessons.html">Lessons</a></li>
        </ul>
        <div class="switch-bar">
            <button class="java-button active" onclick="switchCode('java')">Java</button>
            <button class="kotlin-button" onclick="switchCode('kotlin')">Kotlin</button>
        </div>
        <button id="theme-toggle" aria-label="Toggle Dark Mode">☀</button>
    </nav>

    <!-- Main Content -->
    <header>
        <h1>Welcome to PID Programming</h1>
        <p>Learn what is a PID Controller and how to make your own</p>
    </header>

    <!-- Video Section -->
    <section>
        <h2>Watch a Video on PID Loops</h2>
        <iframe width="560" height="315" src="https://www.youtube.com/embed/example_video_id" 
            title="PID Loop Explanation" allowfullscreen>
        </iframe>
    </section>

    <!-- PID Description Section -->
    <section>
        <h2>What is a PID Loop?</h2>
        <p>
            A PID (Proportional-Integral-Derivative) loop is a control algorithm used in robotics to achieve precise control of motors or other actuators. 
            In the context of FTC Robotics, PID loops are commonly used to maintain consistent speed, position, or orientation of a robot. 
            By adjusting the proportional, integral, and derivative terms, teams can fine-tune their robot's behavior to respond effectively to changes in the environment.
        </p>
    </section>

    <!-- Code Example Section -->
    <section>
        <h2>How to Code a PID in the FTC Robot Controller</h2>
        <div class="code-box">
            <pre class="java-code" style="display: block;">
<code>
public class PIDController {
    private double kP, kI, kD;
    private double previousError = 0;
    private double integral = 0;

    public PIDController(double kP, double kI, double kD) {
        this.kP = kP;
        this.kI = kI;
        this.kD = kD;
    }

    public double calculate(double target, double current) {
        double error = target - current;
        integral += error;
        double derivative = error - previousError;
        previousError = error;
        return (kP * error) + (kI * integral) + (kD * derivative);
    }
}
</code>
            </pre>
            <pre class="kotlin-code" style="display: none;">
<code>
class PIDController(private val kP: Double, private val kI: Double, private val kD: Double) { 
    private var previousError = 0.0
    private var integral = 0.0

    fun calculate(target: Double, current: Double): Double {
        val error = target - current
        integral += error
        val derivative = error - previousError
        previousError = error
        return (kP * error) + (kI * integral) + (kD * derivative)
    }
}
</code>
            </pre>
        </div>
    </section>

    <!-- Step-by-Step Walkthrough Section -->
    <section>
        <h2>Step-by-Step Walkthrough of the PID Code</h2>

        <!-- Step 1 -->
        <section>
            <h3>Step 1: Define the PIDController Class</h3>
            <p>Start by defining the class that will encapsulate the PID logic.</p>
            <div class="code-box">
                <pre class="java-code" style="display: block;">
<code>
public class PIDController {
}
</code>
                </pre>
                <pre class="kotlin-code" style="display: none;">
<code>
class PIDController {
}
</code>
                </pre>
            </div>
        </section>

        <!-- Step 2 -->
        <section>
            <h3>Step 2: Declare Constants</h3>
            <p>Declare constants for proportional, integral, and derivative terms.</p>
            <div class="code-box">
                <pre class="java-code" style="display: block;">
<code>
public class PIDController {
    private double kP, kI, kD;
}
</code>
                </pre>
                <pre class="kotlin-code" style="display: none;">
<code>
class PIDController(private val kP: Double, private val kI: Double, private val kD: Double) {
}
</code>
                </pre>
            </div>
        </section>

        <!-- Step 3 -->
        <section>
            <h3>Step 3: Track Previous Error</h3>
            <p>Track the previous error to calculate the derivative term.</p>
            <div class="code-box">
                <pre class="java-code" style="display: block;">
<code>
public class PIDController {
    private double kP, kI, kD;
    private double previousError = 0;
}
</code>
                </pre>
                <pre class="kotlin-code" style="display: none;">
<code>
class PIDController(private val kP: Double, private val kI: Double, private val kD: Double) {
    private var previousError = 0.0
}
</code>
                </pre>
            </div>
        </section>

        <!-- Step 4 -->
        <section>
            <h3>Step 4: Track Integral</h3>
            <p>Track the integral of errors over time for the integral term.</p>
            <div class="code-box">
                <pre class="java-code" style="display: block;">
<code>
public class PIDController {
    private double kP, kI, kD;
    private double previousError = 0;
    private double integral = 0;
}
</code>
                </pre>
                <pre class="kotlin-code" style="display: none;">
<code>
class PIDController(private val kP: Double, private val kI: Double, private val kD: Double) {
    private var previousError = 0.0
    private var integral = 0.0
}
</code>
                </pre>
            </div>
        </section>

        <!-- Step 5 -->
        <section>
            <h3>Step 5: Constructor</h3>
            <p>Create a constructor to initialize the PID constants.</p>
            <div class="code-box">
                <pre class="java-code" style="display: block;">
<code>
public class PIDController {
    private double kP, kI, kD;
    private double previousError = 0;
    private double integral = 0;

    public PIDController(double kP, double kI, double kD) {
        this.kP = kP;
        this.kI = kI;
        this.kD = kD;
    }
}
</code>
                </pre>
                <pre class="kotlin-code" style="display: none;">
<code>
class PIDController(private val kP: Double, private val kI: Double, private val kD: Double) {
    private var previousError = 0.0
    private var integral = 0.0

    init {
        // Initialization logic if needed
    }
}
</code>
                </pre>
            </div>
        </section>

        <!-- Step 6 -->
        <section>
            <h3>Step 6: Calculate PID Output</h3>
            <p>Implement the method to calculate the PID output based on the target and current values.</p>
            <div class="code-box">
                <pre class="java-code" style="display: block;">
<code>
public class PIDController {
    private double kP, kI, kD;
    private double previousError = 0;
    private double integral = 0;

    public PIDController(double kP, double kI, double kD) {
        this.kP = kP;
        this.kI = kI;
        this.kD = kD;
    }

    public double calculate(double target, double current) {
        double error = target - current; // Calculate the error
        integral += error; // Accumulate the error for the integral term
        double derivative = error - previousError; // Calculate the rate of change of error
        previousError = error; // Update the previous error
        return (kP * error) + (kI * integral) + (kD * derivative); // Compute the PID output
    }
}
</code>
                </pre>
                <pre class="kotlin-code" style="display: none;">
<code>
class PIDController(private val kP: Double, private val kI: Double, private val kD: Double) {
    private var previousError = 0.0
    private var integral = 0.0

    fun calculate(target: Double, current: Double): Double {
        val error = target - current // Calculate the error
        integral += error // Accumulate the error for the integral term
        val derivative = error - previousError // Calculate the rate of change of error
        previousError = error // Update the previous error
        return (kP * error) + (kI * integral) + (kD * derivative) // Compute the PID output
    }
}
</code>
                </pre>
            </div>
        </section>
    </section>
</body>
</html>